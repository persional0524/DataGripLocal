-- create view V_CPM_ACCOUNT as
select
  a.ACCOUNT_ID,
  a.SUBJECT_ID,
  a.CUR_CODE,
  a.BTY_ID,
  a.BRANCH_NO,
  a.ACCOUNT_NO,
  a.ACCOUNT_NAME,
  a.BIZ_CODE,
  a.ACCOUNT_STATE,
  a.OPEN_DATE,
  a.END_DATE,
  a.CLEAR_DATE,
  a.INIT_DATE,
  a.INIT_BALANCE,
  a."REMARK",
  a.IS_OVERDUE,
  a.IS_POSTPONE,
  a.POSTPONE_DATE,
  a.TX_OP_CODE,
  a.CONTRACT_NO,
  b.TYPE_ID,
  b.MC_ID,
  b.CUST_ID,
  c.BALANCE_DIR,
  b.BALANCE_DIR as "BALANCE_DIR1",
  b.OVER_MODE,
  b.is_overdraft,
  b.OVER_LIMITATION,
  b.OFF_BALANCE_FLAG,
  b.FLOOR_AMOUNT,
  b.INTER_BRANCH_FLAG,
  b.SOURCE_MARK,
  b.THIRD_CUSTOM_ID,
  b.SOURCE_ACC_DATE,
  b.SOURCE_ACC_NO,
  b.FINGER_PRINT,
  b.ACC_CLASS,
  c.SUBJECT_NO,
  c.SUBJECT_NAME,
  d.cust_no,
  d.cust_name,
  b.VALIDATE_MODE,
  b.IS_OFF_SHORE,
  b.IS_BILLING,
  b.BIZ_FILL_MODE,
  b.CREATE_WAY,
  C.LEAF_FLAG AS SUBJECT_ISLEAF
from CPM_BOOK_UNIT a
join CPM_ACCOUNT b  on a.ACCOUNT_ID=b.ACCOUNT_ID
join Cpm_Subject c on a.SUBJECT_ID=c.SUBJECT_ID
join cpm_customer d on b.cust_id=d.cust_id;
